<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Power Generation Financial Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            background-color: #f8f9fa;
        }
        .card {
            margin: 20px 0;
        }
        .chart-container {
            position: relative;
            height: 400px;
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <h1 class="text-center">Power Generation Financial Dashboard</h1>
        <p class="text-center text-muted">Analyze and visualize key financial metrics for your project</p>

        <!-- Key Metrics Section -->
        <div class="row text-center">
            <div class="col-md-3">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Net Present Value (NPV)</h5>
                        <p id="npv" class="card-text text-success">$0.00</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Internal Rate of Return (IRR)</h5>
                        <p id="irr" class="card-text text-primary">0.00%</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Payback Period</h5>
                        <p id="payback" class="card-text text-warning">0 years</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">LCOE</h5>
                        <p id="lcoe" class="card-text text-danger">$0.00/kWh</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts Section -->
        <div class="row">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Annual Revenues vs Expenses</h5>
                        <div class="chart-container">
                            <canvas id="revenueExpenseChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Cumulative Cash Flow</h5>
                        <div class="chart-container">
                            <canvas id="cashFlowChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Input Section -->
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Project Parameters</h5>
                <form id="parametersForm">
                    <div class="row">
                        <div class="col-md-4">
                            <label for="discountRate" class="form-label">Discount Rate (%)</label>
                            <input type="number" class="form-control" id="discountRate" placeholder="e.g., 10">
                        </div>
                        <div class="col-md-4">
                            <label for="fuelCost" class="form-label">Fuel Cost ($/unit)</label>
                            <input type="number" class="form-control" id="fuelCost" placeholder="e.g., 0.40">
                        </div>
                        <div class="col-md-4">
                            <label for="projectLifespan" class="form-label">Project Lifespan (years)</label>
                            <input type="number" class="form-control" id="projectLifespan" placeholder="e.g., 20">
                        </div>
                    </div>
                    <button type="button" class="btn btn-primary mt-3" onclick="calculateMetrics()">Calculate</button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Sample Data for Charts
        const revenues = [10000, 12000, 14000, 16000, 18000];
        const expenses = [8000, 8500, 9000, 9500, 10000];
        const cumulativeCashFlow = [2000, 4500, 8000, 11500, 15000];

        // Render Revenue vs Expense Chart
        const revenueExpenseCtx = document.getElementById('revenueExpenseChart').getContext('2d');
        new Chart(revenueExpenseCtx, {
            type: 'bar',
            data: {
                labels: ['Year 1', 'Year 2', 'Year 3', 'Year 4', 'Year 5'],
                datasets: [
                    {
                        label: 'Revenues ($)',
                        data: revenues,
                        backgroundColor: 'rgba(75, 192, 192, 0.6)'
                    },
                    {
                        label: 'Expenses ($)',
                        data: expenses,
                        backgroundColor: 'rgba(255, 99, 132, 0.6)'
                    }
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { position: 'top' },
                }
            }
        });

        // Render Cumulative Cash Flow Chart
        const cashFlowCtx = document.getElementById('cashFlowChart').getContext('2d');
        new Chart(cashFlowCtx, {
            type: 'line',
            data: {
                labels: ['Year 1', 'Year 2', 'Year 3', 'Year 4', 'Year 5'],
                datasets: [
                    {
                        label: 'Cumulative Cash Flow ($)',
                        data: cumulativeCashFlow,
                        borderColor: 'rgba(54, 162, 235, 0.8)',
                        borderWidth: 2,
                        fill: false
                    }
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { position: 'top' },
                }
            }
        });

        // Calculate Financial Metrics
        function calculateMetrics() {
            const discountRate = parseFloat(document.getElementById('discountRate').value) / 100;
            const fuelCost = parseFloat(document.getElementById('fuelCost').value);
            const lifespan = parseInt(document.getElementById('projectLifespan').value);

            // Example calculations (replace with real logic)
            const npv = revenues.reduce((acc, rev, i) => acc + rev / Math.pow(1 + discountRate, i + 1), 0) - 50000;
            const irr = ((revenues.reduce((a, b) => a + b, 0) / 50000) * 100).toFixed(2);
            const payback = revenues.reduce((acc, rev, i) => {
                acc.sum += rev;
                if (acc.sum >= 50000 && acc.years === 0) acc.years = i + 1;
                return acc;
            }, { sum: 0, years: 0 }).years;
            const lcoe = (fuelCost * 1000 / lifespan).toFixed(2);

            // Update UI
            document.getElementById('npv').textContent = `$${npv.toFixed(2)}`;
            document.getElementById('irr').textContent = `${irr}%`;
            document.getElementById('payback').textContent = `${payback} years`;
            document.getElementById('lcoe').textContent = `$${lcoe}/kWh`;
        }
    </script>
</body>
</html>
